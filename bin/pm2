#!/usr/bin/env bash

function show_usage {
    echo "pm2 [raysoda|rapixel|osoky|drypot] [dev|live]"
    exit 1
}

if [ $# -lt 2 ]; then
    show_usage
fi

if [ "$2" = dev ]; then
    OPT=dev
    export NODE_ENV=development
elif [ "$2" = live ]; then
    OPT=live
    export NODE_ENV=production
else
    show_usage
fi

args=(
    start
    bin/pm2-runner.mjs
    --name $1
    --exp-backoff-restart-delay=2000
    --
    config/${1}-${OPT}.json
)

pm2 "${args[@]}"

